# Example SessionData Structures

This document provides example SessionData structures for testing and reference.

## Minimal Valid SessionData

The absolute minimum required for a valid session:

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'targetDate', datetime('2025-01-15'), ...
    'cases', [], ...
    'labIds', 1:6 ...
);
```

## Empty Session (No Cases, No Schedule)

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'appVersion', '1.0.0', ...
    'savedDate', datetime('2025-01-15 10:30:00'), ...
    'targetDate', datetime('2025-01-20'), ...
    'userNotes', '', ...
    'cases', [], ...
    'completedCases', [], ...
    'optimizedSchedule', struct(), ...
    'simulatedSchedule', struct(), ...
    'optimizationOutcome', struct(), ...
    'opts', struct(...
        'turnover', 30, ...
        'setup', 15, ...
        'post', 15, ...
        'maxOpMin', 480, ...
        'enforceMidnight', true, ...
        'prioritizeOutpt', true, ...
        'caseFilter', "all", ...
        'metric', "operatorIdle", ...
        'labs', 6), ...
    'labIds', 1:6, ...
    'availableLabIds', 1:6, ...
    'lockedCaseIds', string.empty, ...
    'timeControlState', struct(...
        'isActive', false, ...
        'currentTimeMinutes', NaN, ...
        'baselineLockedIds', string.empty, ...
        'lockedCaseIds', string.empty), ...
    'operatorColors', struct('keys', {{}}, 'values', {{}}), ...
    'isOptimizationDirty', false, ...
    'historicalDataPath', '' ...
);
```

## Session with Cases (No Schedule)

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'appVersion', '1.0.0', ...
    'savedDate', datetime('now'), ...
    'targetDate', datetime('2025-01-20'), ...
    'userNotes', 'Session with test cases', ...
    'cases', [...
        struct(...
            'operatorName', 'Dr. Smith', ...
            'procedureName', 'Procedure A', ...
            'estimatedDurationMinutes', 60, ...
            'admissionStatus', 'outpatient', ...
            'specificLab', '', ...
            'isFirstCaseOfDay', false, ...
            'caseStatus', 'pending', ...
            'isLocked', false), ...
        struct(...
            'operatorName', 'Dr. Jones', ...
            'procedureName', 'Procedure B', ...
            'estimatedDurationMinutes', 90, ...
            'admissionStatus', 'inpatient', ...
            'specificLab', 'Lab 1', ...
            'isFirstCaseOfDay', true, ...
            'caseStatus', 'pending', ...
            'isLocked', false)...
    ], ...
    'completedCases', [], ...
    'optimizedSchedule', struct(), ...
    'simulatedSchedule', struct(), ...
    'optimizationOutcome', struct(), ...
    'opts', struct(...
        'turnover', 30, ...
        'setup', 15, ...
        'post', 15, ...
        'maxOpMin', 480, ...
        'enforceMidnight', true, ...
        'prioritizeOutpt', true, ...
        'caseFilter', "all", ...
        'metric', "operatorIdle", ...
        'labs', 6), ...
    'labIds', 1:6, ...
    'availableLabIds', 1:6, ...
    'lockedCaseIds', string.empty, ...
    'timeControlState', struct(...
        'isActive', false, ...
        'currentTimeMinutes', NaN, ...
        'baselineLockedIds', string.empty, ...
        'lockedCaseIds', string.empty), ...
    'operatorColors', struct(...
        'keys', {{'Dr. Smith', 'Dr. Jones'}}, ...
        'values', {{[0.2, 0.4, 0.8], [0.8, 0.2, 0.2]}}), ...
    'isOptimizationDirty', true, ...
    'historicalDataPath', '' ...
);
```

## Session with Locked Cases

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'targetDate', datetime('2025-01-20'), ...
    'cases', [...
        struct(...
            'operatorName', 'Dr. Smith', ...
            'procedureName', 'Procedure A', ...
            'estimatedDurationMinutes', 60, ...
            'admissionStatus', 'outpatient', ...
            'specificLab', '', ...
            'isFirstCaseOfDay', false, ...
            'caseStatus', 'in_progress', ...
            'isLocked', true), ...
        struct(...
            'operatorName', 'Dr. Jones', ...
            'procedureName', 'Procedure B', ...
            'estimatedDurationMinutes', 90, ...
            'admissionStatus', 'outpatient', ...
            'specificLab', '', ...
            'isFirstCaseOfDay', false, ...
            'caseStatus', 'pending', ...
            'isLocked', false)...
    ], ...
    'lockedCaseIds', ["1"], ...
    % ... other fields ...
);
```

## Session with Time Control Active

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'targetDate', datetime('2025-01-20'), ...
    'cases', [...
        struct(...
            'operatorName', 'Dr. Smith', ...
            'procedureName', 'Procedure A', ...
            'estimatedDurationMinutes', 60, ...
            'admissionStatus', 'outpatient', ...
            'specificLab', '', ...
            'isFirstCaseOfDay', false, ...
            'caseStatus', 'completed', ...
            'isLocked', true)...
    ], ...
    'timeControlState', struct(...
        'isActive', true, ...
        'currentTimeMinutes', 540, ...  % 9:00 AM
        'baselineLockedIds', string.empty, ...
        'lockedCaseIds', ["1"]), ...
    'lockedCaseIds', ["1"], ...
    % ... other fields ...
);
```

## Session with Optimized Schedule

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'targetDate', datetime('2025-01-20'), ...
    'cases', [struct(...)], ...  % Case structs
    'optimizedSchedule', struct(...
        'date', datetime('2025-01-20'), ...
        'labs', [...  % Array of serialized Lab structs
            struct('id', 1), ...
            struct('id', 2)...
        ], ...
        'labAssignments', {{...  % Cell array of lab assignments
            [struct(...)], ...  % Lab 1 cases
            [struct(...)]...    % Lab 2 cases
        }}, ...
        'metrics', struct(...
            'makespan', 720, ...
            'operatorIdle', 45, ...
            'labIdle', 30)), ...
    'optimizationOutcome', struct(...
        'success', true, ...
        'message', 'Optimization completed', ...
        'runtime', 2.5), ...
    'isOptimizationDirty', false, ...
    % ... other fields ...
);
```

## Session with Historical Data Reference

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'targetDate', datetime('2025-01-20'), ...
    'cases', [], ...
    'historicalDataPath', '/path/to/historical_collection.mat', ...
    % ... other fields ...
);
```

## Invalid/Corrupt Examples (For Error Testing)

### Missing Required Field (Version)

```matlab
sessionData = struct(...
    'targetDate', datetime('2025-01-20'), ...
    'cases', [] ...
    % Missing 'version' field - should error
);
```

### Invalid Version

```matlab
sessionData = struct(...
    'version', '999.0.0', ...  % Future version - should warn
    'targetDate', datetime('2025-01-20'), ...
    'cases', [] ...
);
```

### Invalid Date

```matlab
sessionData = struct(...
    'version', '1.0.0', ...
    'targetDate', NaT, ...  % Invalid date - should use default
    'cases', [] ...
);
```

### Wrong Data Types

```matlab
sessionData = struct(...
    'version', 1.0, ...  % Should be string, not double
    'targetDate', '2025-01-20', ...  % Should be datetime, not string
    'cases', {} ...  % Should be struct array, not cell
);
```

## Usage in Tests

```matlab
% Create minimal session
sessionData = createTestSessionData();

% Modify for specific test
sessionData.cases = [...
    struct('operatorName', 'Dr. Test', ...)
];

% Save to file
conduction.session.saveSessionToFile(sessionData, 'test_session.mat');

% Load and validate
loaded = conduction.session.loadSessionFromFile('test_session.mat');
assert(isequal(loaded.version, sessionData.version));
```
